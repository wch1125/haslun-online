/* ═══════════════════════════════════════════════════════════════════════════
   HOTLINE ATMOSPHERE — Life, Transitions, and Danger
   
   "If the UI feels calm, something is broken."
   
   This file adds:
   - Section transitions (glitch-in, static-burst)
   - Idle ambient animations (flicker, breathe, drift)
   - Entrance animations for elements
   - Hover micro-animations
   - State change effects
   - Environmental noise
   ═══════════════════════════════════════════════════════════════════════════ */

/* ═══════════════════════════════════════════════════════════════════════════
   0. GLOBAL ANIMATION VARIABLES
   ═══════════════════════════════════════════════════════════════════════════ */

:root {
  /* Timing - everything slightly off-rhythm */
  --atmo-fast: 0.08s;
  --atmo-quick: 0.15s;
  --atmo-normal: 0.3s;
  --atmo-slow: 0.6s;
  --atmo-drift: 4s;
  
  /* Hotline palette */
  --atmo-pink: #ff0066;
  --atmo-magenta: #ff2fd2;
  --atmo-lime: #aaff00;
  --atmo-cyan: #00ffcc;
  --atmo-orange: #ff7a00;
  --atmo-blood: #2a001f;
  --atmo-void: #0a0008;
}

/* ═══════════════════════════════════════════════════════════════════════════
   1. PAGE/SECTION TRANSITIONS — Glitch between views
   ═══════════════════════════════════════════════════════════════════════════ */

/* Base transition wrapper */
.section-enter {
  animation: sectionGlitchIn 0.4s steps(8) forwards;
}

.section-exit {
  animation: sectionGlitchOut 0.25s steps(6) forwards;
}

@keyframes sectionGlitchIn {
  0% {
    opacity: 0;
    transform: translateX(-8px) skewX(-2deg);
    filter: brightness(2) saturate(0);
    clip-path: inset(0 100% 0 0);
  }
  20% {
    opacity: 1;
    clip-path: inset(0 60% 0 0);
    filter: brightness(1.5) saturate(0.5);
  }
  40% {
    transform: translateX(4px) skewX(1deg);
    clip-path: inset(0 30% 0 0);
  }
  60% {
    transform: translateX(-2px) skewX(-0.5deg);
    clip-path: inset(0 10% 0 0);
    filter: brightness(1.2) saturate(0.8);
  }
  80% {
    transform: translateX(1px);
    clip-path: inset(0 0 0 0);
  }
  100% {
    opacity: 1;
    transform: translateX(0) skewX(0);
    filter: brightness(1) saturate(1);
    clip-path: inset(0 0 0 0);
  }
}

@keyframes sectionGlitchOut {
  0% {
    opacity: 1;
    transform: translateX(0);
  }
  30% {
    transform: translateX(5px) skewX(2deg);
    filter: brightness(1.3);
  }
  60% {
    opacity: 0.5;
    transform: translateX(-10px) skewX(-3deg);
    filter: brightness(0.7) saturate(0);
  }
  100% {
    opacity: 0;
    transform: translateX(20px);
    filter: brightness(0);
  }
}

/* Static burst between sections */
@keyframes staticBurst {
  0%, 100% { 
    background-image: none; 
  }
  10%, 30%, 50%, 70%, 90% {
    background-image: url('data:image/svg+xml,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>');
    background-size: 150px;
    opacity: 0.15;
  }
  20%, 40%, 60%, 80% {
    background-image: none;
  }
}

/* Tab/nav transitions */
.nav-tab,
.mobile-nav-item,
[role="tab"] {
  position: relative;
  overflow: hidden;
}

.nav-tab::after,
.mobile-nav-item::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, var(--atmo-pink), transparent);
  transform: translateX(-100%);
  opacity: 0;
  transition: none;
}

.nav-tab:hover::after,
.mobile-nav-item:hover::after {
  animation: scanPass 0.3s steps(6) forwards;
}

@keyframes scanPass {
  0% {
    transform: translateX(-100%);
    opacity: 0.4;
  }
  100% {
    transform: translateX(100%);
    opacity: 0;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   2. ELEMENT ENTRANCE ANIMATIONS — Staggered danger
   ═══════════════════════════════════════════════════════════════════════════ */

/* Cards cascade in */
.fleet-ship-card,
.stat-block,
.equipment-slot,
.carousel-ship-card {
  animation: elementSlideIn 0.3s steps(6) backwards;
}

.fleet-ship-card:nth-child(1) { animation-delay: 0.05s; }
.fleet-ship-card:nth-child(2) { animation-delay: 0.1s; }
.fleet-ship-card:nth-child(3) { animation-delay: 0.15s; }
.fleet-ship-card:nth-child(4) { animation-delay: 0.2s; }
.fleet-ship-card:nth-child(5) { animation-delay: 0.25s; }
.fleet-ship-card:nth-child(6) { animation-delay: 0.3s; }
.fleet-ship-card:nth-child(n+7) { animation-delay: 0.35s; }

.stat-block:nth-child(1) { animation-delay: 0.1s; }
.stat-block:nth-child(2) { animation-delay: 0.18s; }
.stat-block:nth-child(3) { animation-delay: 0.26s; }
.stat-block:nth-child(4) { animation-delay: 0.34s; }

@keyframes elementSlideIn {
  0% {
    opacity: 0;
    transform: translateY(10px) scaleY(0.95);
    filter: brightness(0.5);
  }
  50% {
    opacity: 0.7;
    transform: translateY(-2px) scaleY(1.01);
    filter: brightness(1.3);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scaleY(1);
    filter: brightness(1);
  }
}

/* Buttons punch in */
button,
.bey-btn,
.action-btn {
  animation: buttonPunchIn 0.2s steps(4) backwards;
  animation-delay: 0.3s;
}

@keyframes buttonPunchIn {
  0% {
    opacity: 0;
    transform: scale(0.9);
    box-shadow: none;
  }
  50% {
    opacity: 1;
    transform: scale(1.05);
    box-shadow: 0 0 20px var(--atmo-pink);
  }
  100% {
    transform: scale(1);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   3. IDLE AMBIENT ANIMATIONS — The UI is never still
   ═══════════════════════════════════════════════════════════════════════════ */

/* Subtle global screen flicker */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 99999;
  animation: screenFlicker 8s steps(1) infinite;
  opacity: 0;
}

@keyframes screenFlicker {
  0%, 94%, 96%, 98%, 100% { opacity: 0; }
  95% { opacity: 0.02; background: var(--atmo-pink); }
  97% { opacity: 0.015; background: var(--atmo-cyan); }
  99% { opacity: 0.01; background: #fff; }
}

/* Panel breathing - very subtle */
.stat-block,
.bey-panel,
.hangar-sidebar {
  animation: panelBreathe 6s ease-in-out infinite;
}

.stat-block:nth-child(odd) { animation-delay: -2s; }
.stat-block:nth-child(even) { animation-delay: -4s; }

@keyframes panelBreathe {
  0%, 100% {
    box-shadow: inset 0 0 30px rgba(255, 0, 102, 0.02);
  }
  50% {
    box-shadow: inset 0 0 50px rgba(255, 0, 102, 0.05);
  }
}

/* Border pulse on active elements */
.fleet-ship-card.active,
.nav-tab.active,
.stat-block:focus-within {
  animation: borderPulse 2s steps(4) infinite;
}

@keyframes borderPulse {
  0%, 100% {
    border-color: var(--atmo-pink);
    box-shadow: 0 0 15px rgba(255, 0, 102, 0.2);
  }
  50% {
    border-color: var(--atmo-magenta);
    box-shadow: 0 0 25px rgba(255, 0, 102, 0.35);
  }
}

/* Status indicators - irregular blink */
.status-dot,
.live-indicator,
[class*="status-online"],
[class*="status-active"] {
  animation: irregularBlink 3s steps(1) infinite;
}

@keyframes irregularBlink {
  0%, 18%, 22%, 100% { opacity: 1; }
  20% { opacity: 0.3; }
  45%, 47% { opacity: 0.6; }
  46% { opacity: 0.2; }
  75%, 77% { opacity: 1; }
  76% { opacity: 0.4; }
}

/* Text value flicker for live data */
.stat-value,
.fleet-card-value,
.pilot-ticker,
[class*="price"],
[class*="value"] {
  animation: valueFlicker 5s steps(1) infinite;
}

@keyframes valueFlicker {
  0%, 92%, 94%, 96%, 98%, 100% {
    text-shadow: 0 0 8px currentColor;
    opacity: 1;
  }
  93%, 95% {
    text-shadow: 0 0 15px currentColor, 0 0 30px currentColor;
    opacity: 0.9;
  }
  97%, 99% {
    text-shadow: 0 0 5px currentColor;
    opacity: 0.95;
  }
}

/* Ship sprites idle drift */
.fleet-card-sprite,
.ship-display img,
.carousel-ship-card img,
[class*="ship-sprite"] {
  animation: shipIdleDrift 4s steps(8) infinite;
}

@keyframes shipIdleDrift {
  0%, 100% {
    transform: translateY(0) rotate(0deg);
    filter: drop-shadow(0 0 8px rgba(255, 0, 102, 0.3));
  }
  25% {
    transform: translateY(-2px) rotate(0.5deg);
  }
  50% {
    transform: translateY(1px) rotate(-0.3deg);
    filter: drop-shadow(0 0 12px rgba(255, 0, 102, 0.4));
  }
  75% {
    transform: translateY(-1px) rotate(0.2deg);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   4. HOVER MICRO-ANIMATIONS — Danger response
   ═══════════════════════════════════════════════════════════════════════════ */

/* Cards lift and threaten */
.fleet-ship-card:hover,
.stat-block:hover,
.carousel-ship-card:hover {
  animation: hoverThreat 0.15s steps(3) forwards;
}

@keyframes hoverThreat {
  0% {
    transform: translateY(0);
  }
  33% {
    transform: translateY(-3px) translateX(1px);
    filter: brightness(1.1);
  }
  66% {
    transform: translateY(-2px) translateX(-1px);
  }
  100% {
    transform: translateY(-2px);
    filter: brightness(1.05);
  }
}

/* Buttons crackle on hover */
button:hover,
.bey-btn:hover,
.action-btn:hover {
  animation: buttonCrackle 0.2s steps(4);
}

@keyframes buttonCrackle {
  0% { 
    transform: scale(1);
    filter: brightness(1);
  }
  25% { 
    transform: scale(1.02) skewX(-1deg);
    filter: brightness(1.2);
  }
  50% { 
    transform: scale(0.99) skewX(0.5deg);
    filter: brightness(0.95);
  }
  75% { 
    transform: scale(1.01);
    filter: brightness(1.15);
  }
  100% { 
    transform: scale(1);
    filter: brightness(1.1);
  }
}

/* Input focus surge */
input:focus,
select:focus,
textarea:focus {
  animation: inputSurge 0.2s steps(4) forwards;
}

@keyframes inputSurge {
  0% {
    box-shadow: 0 0 0 0 transparent;
  }
  50% {
    box-shadow: 0 0 0 4px rgba(255, 0, 102, 0.4), 0 0 20px rgba(255, 0, 102, 0.3);
  }
  100% {
    box-shadow: 0 0 0 2px rgba(255, 0, 102, 0.3), 0 0 15px rgba(255, 0, 102, 0.2);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   5. STATE CHANGE EFFECTS — When data updates
   ═══════════════════════════════════════════════════════════════════════════ */

/* Value change flash */
.value-updated,
[data-updated="true"],
.stat-changed {
  animation: valueChange 0.4s steps(6);
}

@keyframes valueChange {
  0% {
    background: transparent;
    color: inherit;
  }
  15% {
    background: rgba(170, 255, 0, 0.3);
    color: var(--atmo-lime);
    text-shadow: 0 0 10px var(--atmo-lime);
  }
  30% {
    background: rgba(170, 255, 0, 0.15);
  }
  50% {
    background: rgba(170, 255, 0, 0.25);
    text-shadow: 0 0 15px var(--atmo-lime);
  }
  100% {
    background: transparent;
    color: inherit;
    text-shadow: none;
  }
}

/* Negative change (loss/damage) */
.value-decreased,
[data-change="negative"],
.stat-damaged {
  animation: valueDamage 0.5s steps(8);
}

@keyframes valueDamage {
  0%, 100% {
    transform: translateX(0);
    filter: none;
  }
  10% { transform: translateX(-3px); }
  20% { transform: translateX(4px); filter: brightness(1.3) saturate(1.5); }
  30% { transform: translateX(-2px); }
  40% { transform: translateX(2px); }
  50% { 
    transform: translateX(-1px); 
    background: rgba(255, 0, 102, 0.2);
  }
  60% { transform: translateX(1px); }
  70% { transform: translateX(0); }
}

/* Loading pulse */
.loading,
[aria-busy="true"],
.fetching {
  animation: loadingPulse 1s steps(4) infinite;
}

@keyframes loadingPulse {
  0%, 100% {
    opacity: 1;
    filter: brightness(1);
  }
  25% {
    opacity: 0.6;
    filter: brightness(0.8);
  }
  50% {
    opacity: 0.9;
    filter: brightness(1.2);
  }
  75% {
    opacity: 0.5;
    filter: brightness(0.7);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   6. ENVIRONMENTAL OVERLAYS — Always present danger
   ═══════════════════════════════════════════════════════════════════════════ */

/* Scanline overlay for main content */
.hangar-rpg::after,
.bey-arena-shell .bey-scanlines,
main::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: repeating-linear-gradient(
    0deg,
    transparent 0px,
    transparent 2px,
    rgba(0, 0, 0, 0.08) 2px,
    rgba(0, 0, 0, 0.08) 4px
  );
  z-index: 1000;
}

/* Vignette danger edges */
.hangar-rpg,
.bey-arena-shell,
main {
  position: relative;
}

.hangar-rpg::before,
main::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  box-shadow: 
    inset 0 0 150px rgba(10, 0, 8, 0.6),
    inset 0 0 50px rgba(255, 0, 102, 0.05);
  z-index: 999;
}

/* Corner noise accents */
.stat-block::before,
.fleet-ship-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 30%;
  height: 30%;
  background: 
    radial-gradient(ellipse at 0% 0%, rgba(255, 0, 102, 0.1), transparent 70%);
  pointer-events: none;
  opacity: 0.5;
  animation: cornerGlow 4s ease-in-out infinite alternate;
}

@keyframes cornerGlow {
  0% { opacity: 0.3; }
  100% { opacity: 0.6; }
}

/* ═══════════════════════════════════════════════════════════════════════════
   7. MODAL/OVERLAY TRANSITIONS — Dramatic reveals
   ═══════════════════════════════════════════════════════════════════════════ */

/* Modal slam-in */
.modal,
.overlay,
.dialog,
[role="dialog"] {
  animation: modalSlam 0.25s steps(6) forwards;
}

@keyframes modalSlam {
  0% {
    opacity: 0;
    transform: scale(1.1) translateY(-20px);
    filter: blur(10px) brightness(2);
  }
  40% {
    opacity: 1;
    transform: scale(0.98) translateY(5px);
    filter: blur(0) brightness(1.3);
  }
  70% {
    transform: scale(1.01) translateY(-2px);
    filter: brightness(1.1);
  }
  100% {
    transform: scale(1) translateY(0);
    filter: brightness(1);
  }
}

/* Modal backdrop pulse */
.modal-backdrop,
.overlay-backdrop,
.bey-arena-overlay {
  animation: backdropPulse 3s ease-in-out infinite;
}

@keyframes backdropPulse {
  0%, 100% {
    background: rgba(10, 0, 8, 0.92);
  }
  50% {
    background: rgba(20, 0, 15, 0.94);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   8. SHIP SELECTION EFFECTS — Choosing feels consequential
   ═══════════════════════════════════════════════════════════════════════════ */

/* Ship selected confirmation */
.fleet-ship-card.active,
.carousel-ship-card.active {
  animation: shipSelected 0.3s steps(6);
}

@keyframes shipSelected {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 var(--atmo-pink);
  }
  30% {
    transform: scale(1.03);
    box-shadow: 0 0 0 4px var(--atmo-pink), 0 0 30px var(--atmo-pink);
  }
  60% {
    transform: scale(0.99);
    box-shadow: 0 0 0 2px var(--atmo-pink), 0 0 20px var(--atmo-pink);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 1px var(--atmo-pink), 0 0 15px rgba(255, 0, 102, 0.3);
  }
}

/* Ship hover preview */
.fleet-ship-card:hover .fleet-card-sprite,
.carousel-ship-card:hover img {
  animation: spritePreview 0.3s steps(4);
}

@keyframes spritePreview {
  0% {
    transform: scale(1) rotate(0);
  }
  25% {
    transform: scale(1.1) rotate(-2deg);
    filter: drop-shadow(0 0 15px var(--atmo-pink));
  }
  50% {
    transform: scale(1.15) rotate(1deg);
    filter: drop-shadow(0 0 20px var(--atmo-pink));
  }
  100% {
    transform: scale(1.1) rotate(0);
    filter: drop-shadow(0 0 12px var(--atmo-pink));
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   9. PROGRESS/BAR ANIMATIONS — Tension in meters
   ═══════════════════════════════════════════════════════════════════════════ */

/* Stat bars shimmer */
.stat-bar,
.stat-fill,
.fleet-bar-fill,
.stat-bar-fill {
  position: relative;
  overflow: hidden;
}

.stat-bar::after,
.fleet-bar-track::after {
  content: '';
  position: absolute;
  top: 0;
  left: -50%;
  width: 50%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.15),
    transparent
  );
  animation: barShimmer 3s steps(12) infinite;
}

@keyframes barShimmer {
  0% { left: -50%; }
  100% { left: 150%; }
}

/* Critical bar warning */
.stat-bar.critical .stat-fill,
.stat-fill[style*="width: 1"],
.stat-fill[style*="width: 2"] {
  animation: criticalBar 0.5s steps(2) infinite;
}

@keyframes criticalBar {
  0%, 100% { 
    opacity: 1;
    box-shadow: 0 0 10px var(--atmo-pink);
  }
  50% { 
    opacity: 0.6;
    box-shadow: 0 0 20px var(--atmo-pink);
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   10. REDUCED MOTION — Respect user preference
   ═══════════════════════════════════════════════════════════════════════════ */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  /* Keep essential state indicators */
  .loading,
  [aria-busy="true"] {
    animation: loadingPulse 2s steps(2) infinite !important;
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   11. UTILITY CLASSES — For JS-triggered animations
   ═══════════════════════════════════════════════════════════════════════════ */

/* Trigger classes for JavaScript */
.animate-glitch-in {
  animation: sectionGlitchIn 0.4s steps(8) forwards !important;
}

.animate-glitch-out {
  animation: sectionGlitchOut 0.25s steps(6) forwards !important;
}

.animate-shake {
  animation: valueDamage 0.5s steps(8) !important;
}

.animate-flash {
  animation: valueChange 0.4s steps(6) !important;
}

.animate-pulse {
  animation: borderPulse 0.5s steps(4) !important;
}

/* One-shot animation helper */
.animate-once {
  animation-fill-mode: forwards !important;
  animation-iteration-count: 1 !important;
}
